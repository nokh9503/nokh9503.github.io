<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="theme" content="Chirpy v2.6.2"><meta name="generator" content="Jekyll v4.1.1" /><meta property="og:title" content="딥러닝 기반 반려견 울음소리 감지와 감정 및 상태 분석(3)" /><meta name="author" content="nokh9503" /><meta property="og:locale" content="en_US" /><meta name="description" content="4. 프로젝트 결과 4.1 연구 결과" /><meta property="og:description" content="4. 프로젝트 결과 4.1 연구 결과" /><link rel="canonical" href="https://nokh9503.github.io/nokh9503.github.io/posts/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EB%B0%98%EB%A0%A4%EA%B2%AC-%EC%9A%B8%EC%9D%8C%EC%86%8C%EB%A6%AC-%EA%B0%90%EC%A7%80%EC%99%80-%EA%B0%90%EC%A0%95-%EB%B6%84%EC%84%9D(3)/" /><meta property="og:url" content="https://nokh9503.github.io/nokh9503.github.io/posts/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EB%B0%98%EB%A0%A4%EA%B2%AC-%EC%9A%B8%EC%9D%8C%EC%86%8C%EB%A6%AC-%EA%B0%90%EC%A7%80%EC%99%80-%EA%B0%90%EC%A0%95-%EB%B6%84%EC%84%9D(3)/" /><meta property="og:site_name" content="코딩이 싫은 컴공" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-12-13T01:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="딥러닝 기반 반려견 울음소리 감지와 감정 및 상태 분석(3)" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@nokh9503" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"4. 프로젝트 결과 4.1 연구 결과","url":"https://nokh9503.github.io/nokh9503.github.io/posts/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EB%B0%98%EB%A0%A4%EA%B2%AC-%EC%9A%B8%EC%9D%8C%EC%86%8C%EB%A6%AC-%EA%B0%90%EC%A7%80%EC%99%80-%EA%B0%90%EC%A0%95-%EB%B6%84%EC%84%9D(3)/","headline":"딥러닝 기반 반려견 울음소리 감지와 감정 및 상태 분석(3)","dateModified":"2020-12-13T20:33:54+09:00","@type":"BlogPosting","datePublished":"2020-12-13T01:00:00+09:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://nokh9503.github.io/nokh9503.github.io/posts/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EB%B0%98%EB%A0%A4%EA%B2%AC-%EC%9A%B8%EC%9D%8C%EC%86%8C%EB%A6%AC-%EA%B0%90%EC%A7%80%EC%99%80-%EA%B0%90%EC%A0%95-%EB%B6%84%EC%84%9D(3)/"},"author":{"@type":"Person","name":"nokh9503"},"@context":"https://schema.org"}</script><title>딥러닝 기반 반려견 울음소리 감지와 감정 및 상태 분석(3) | 코딩이 싫은 컴공</title><link rel="shortcut icon" href="/nokh9503.github.io/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/nokh9503.github.io/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/nokh9503.github.io/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/nokh9503.github.io/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/nokh9503.github.io/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/nokh9503.github.io/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/nokh9503.github.io/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/nokh9503.github.io/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/nokh9503.github.io/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/nokh9503.github.io/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/nokh9503.github.io/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/nokh9503.github.io/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/nokh9503.github.io/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/nokh9503.github.io/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/nokh9503.github.io/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/nokh9503.github.io/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/nokh9503.github.io/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/nokh9503.github.io/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/nokh9503.github.io/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/nokh9503.github.io/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" href="/nokh9503.github.io/assets/css/post.css" as="style"><link rel="stylesheet" href="/nokh9503.github.io/assets/css/post.css"><link rel="preload" as="style" href="/nokh9503.github.io/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/nokh9503.github.io/assets/css/lib/bootstrap-toc.min.css" /> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="/nokh9503.github.io/assets/js/post.min.js"></script> <script defer src="/nokh9503.github.io/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/nokh9503.github.io/" alt="avatar"> <img src="/nokh9503.github.io/assets/img/profile/me1.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/nokh9503.github.io/">코딩이 싫은 컴공</a></div><div class="site-subtitle font-italic">내가 인공지능이고 인공지능이 나인 물아일체의 경지가 되려고 하는 바보</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/nokh9503.github.io/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/nokh9503.github.io/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/nokh9503.github.io/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/nokh9503.github.io/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/nokh9503.github.io/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <span id="mode-toggle-wrapper"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span> <span class="icon-border"></span> <a href="https://github.com/nokh9503" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','doamin.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/nokh9503.github.io/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/nokh9503.github.io/"> Posts </a> </span> <span>딥러닝 기반 반려견 울음소리 감지와 감정 및 상태 분석(3)</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>딥러닝 기반 반려견 울음소리 감지와 감정 및 상태 분석(3)</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sun, Dec 13, 2020, 1:00 AM +0900" > Dec 13, 2020 <i class="unloaded">2020-12-13T01:00:00+09:00</i> </span> by <span class="author"> nokh9503 </span></div><div> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sun, Dec 13, 2020, 8:33 PM +0900" > Dec 13, 2020 <i class="unloaded">2020-12-13T20:33:54+09:00</i> </span></div></div><div class="post-content"><h2 id="4-프로젝트-결과">4. 프로젝트 결과</h2><h3 id="41-연구-결과">4.1 연구 결과</h3><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/ai/project/test_accuracy.png" alt="test accuracy" /></p><p>  결론부터 말하자면 <code class="language-plaintext highlighter-rouge">Overfitting</code>과 <code class="language-plaintext highlighter-rouge">Underfitting</code>이 둘 다 확인할 수 있었다. 그림에서 왼쪽부터 <code class="language-plaintext highlighter-rouge">CBAM</code>을 마지막 Convolution Block에 적용한 모델 결과 값, 가운데는 모든 Convolution Block에 CBAM을 적용한 결과 값이다. 마지막으로 오른쪽은 CBAM을 적용하지 않은 모델의 결과 값이다.</p><h3 id="42-원인">4.2 원인</h3><p>  연구 결과 4.1에 대한 결과에 대해서 다음과 같은 문제점이 있었다고 판단한다.</p><ul><li>데이터의 부족이다. 앞선 3.2 프로젝트 내용에서 언급했듯이 주로 <strong>YouTube</strong>에서 데이터를 추출했다. 길이가 짧은 동영상들이 대부분이었기 때문에 각 동영상에서 추출할 수 있는 데이터들이 부족했다.<li>이에 따라 딥러닝 연구에 필요한 학습 데이터를 만들기 위해 <code class="language-plaintext highlighter-rouge">Data Augumentation</code>을 했다. 하지만 오히려 데이터를 증강하지 않았을 때보다 더 낮은 <em>Test Accuracy</em> 를 보였다. 일반적인 이미지와는 달리 <code class="language-plaintext highlighter-rouge">Spectrogram</code>은 소리를 시각화한 도구이다. 따라서 <em>뒤틀림</em> 이나 <em>뒤집기</em> 와 같은 방법으로 데이터를 증강했을 경우, 소리가 바뀌어 더 낮은 정확도가 나왔다고 판단했다.<li>또한 딥러닝 연구로서 <strong>clean</strong>하지 못한 데이터들을 가공했지만 완벽하게 <em>노이즈</em> 와 <em>무음 구간</em> 을 처리하지 못했기 때문에 이와 같은 결과가 나왔다고 생각된다.</ul><h3 id="43-데모">4.3 데모</h3><p>  Python 오디오 라이브러리인 <code class="language-plaintext highlighter-rouge">pyaudio</code>를 이용하여 실시간으로 음향을 분석하고 이에 대한 정보를 <code class="language-plaintext highlighter-rouge">Mel-Spectrogram</code> 이미지로 변환한다. <strong>스택</strong>을 이용하여 초당 프레임을 저장하고 일정한 프레임을 만족하면 스택에 쌓여있는 프레임들을 Mel-Spectrogram 이미지로 저장했다. 또한 변환된 이미지는 학습 모델을 통해서 <strong>실시간</strong>으로 분석 및 예측하게 된다.</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">cv2</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">pyaudio</span>
<span class="kn">import</span> <span class="nn">librosa</span>
<span class="kn">import</span> <span class="nn">librosa.display</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="n">tf</span>
<span class="kn">import</span> <span class="nn">tensorflow.keras</span> <span class="k">as</span> <span class="n">keras</span>

<span class="n">CATEGORES</span> <span class="o">=</span> <span class="p">[</span><span class="s">"angry"</span><span class="p">,</span> <span class="s">"happy"</span><span class="p">,</span> <span class="s">"lonely"</span><span class="p">,</span> <span class="s">"sad"</span><span class="p">]</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">keras</span><span class="p">.</span><span class="n">load_model</span><span class="p">(</span><span class="s">"yout model path"</span><span class="p">)</span>
<span class="n">rate</span> <span class="o">=</span> <span class="mi">16000</span>
<span class="n">chunk_size</span> <span class="o">=</span> <span class="n">rate</span> <span class="o">//</span> <span class="mi">4</span>

<span class="s">"""
    생성된 데이터를 모델에 맞게 변경함
    @param filepath(str) : path where your image file is
    @return array that has reshaped for predict
"""</span>
<span class="k">def</span> <span class="nf">prepare</span><span class="p">(</span><span class="n">filepath</span><span class="p">):</span>
    <span class="n">img_array</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="n">imread</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">cv2</span><span class="p">.</span><span class="n">IMREAD_COLOR</span><span class="p">)</span>
    <span class="n">new_array</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">img_array</span><span class="p">,</span> <span class="p">(</span><span class="mi">62</span><span class="p">,</span> <span class="mi">78</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">new_array</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">pyaudio</span><span class="p">.</span><span class="n">PyAudio</span><span class="p">()</span>
<span class="n">stream</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="nb">open</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="n">pyaudio</span><span class="p">.</span><span class="n">paFloat32</span><span class="p">,</span>
                <span class="n">channels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">rate</span><span class="o">=</span><span class="n">rate</span><span class="p">,</span>
                <span class="nb">input</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                <span class="n">input_device_index</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">frames_per_buffer</span><span class="o">=</span><span class="n">chunk_size</span><span class="p">)</span>

<span class="n">frames</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">do_melspec</span> <span class="o">=</span> <span class="n">librosa</span><span class="p">.</span><span class="n">feature</span><span class="p">.</span><span class="n">melspectrogram</span>
<span class="n">pwr_to_db</span> <span class="o">=</span> <span class="n">librosa</span><span class="p">.</span><span class="n">core</span><span class="p">.</span><span class="n">power_to_db</span>

<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">stream</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="n">chunk_size</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">float32</span><span class="p">)</span>
    <span class="n">melspec</span> <span class="o">=</span> <span class="n">do_melspec</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">sr</span><span class="o">=</span><span class="n">rate</span><span class="p">,</span> <span class="n">n_mels</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mi">4000</span><span class="p">)</span>
    <span class="n">norm_melspec</span> <span class="o">=</span> <span class="n">pwr_to_db</span><span class="p">(</span><span class="n">melspec</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nb">max</span><span class="p">)</span>
    <span class="n">frames</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">norm_melspec</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">frames</span><span class="p">)</span> <span class="o">==</span> <span class="mi">20</span><span class="p">:</span>
        
        <span class="n">stack</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">hstack</span><span class="p">(</span><span class="n">frames</span><span class="p">)</span>
        <span class="n">librosa</span><span class="p">.</span><span class="n">display</span><span class="p">.</span><span class="n">specshow</span><span class="p">(</span><span class="n">stack</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mi">4000</span><span class="p">)</span>
        <span class="c1"># LOADED AT 'DB FOLDER' WHERE SPECTROGRAM IMAGE IS
</span>        <span class="n">plt</span><span class="p">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">'your save path'</span> <span class="o">+</span> <span class="s">'.jpg'</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
        <span class="n">prediction</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">predict</span><span class="p">([</span><span class="n">prepare</span><span class="p">(</span><span class="s">'path where your image is'</span><span class="p">)])</span>
        <span class="k">print</span><span class="p">(</span><span class="n">CATEGORES</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">prediction</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])])</span>
        <span class="n">plt</span><span class="p">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="n">plt</span><span class="p">.</span><span class="n">pause</span><span class="p">(</span><span class="mf">0.0001</span><span class="p">)</span>
        <span class="n">plt</span><span class="p">.</span><span class="n">clf</span><span class="p">()</span>
        <span class="c1">#break
</span>        <span class="n">frames</span><span class="p">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>
</pre></table></code></div></div><h2 id="5-결론">5. 결론</h2><p>  인공지능 분야에 대한 연구가 활발히 이어짐에 따라 인공지능을 이용한 반려동물과 반려인을 위한 서비스 수요의 증대와 관심으로 시장가치가 증가하고 있다. 따라서 인공지능을 이용한 반려동물 서비스 분야는 다양한 방향으로 발전할 것으로 보인다. 더불어 감정 상태를 정확히 인식하고 이를 이용하는 기술인 <strong>HCI(Human-Computer Interaction)</strong>, <strong>로봇공학</strong>, <strong>의료진단</strong> 등 여러 분야에서 활용될 수 있다.</p><h2 id="6-참고문헌">6. 참고문헌</h2><p>김강주, 「반려견 분리불안증 해소 웨어러블 디바이스 구현」, 『한국정보통신설비학회 학술대회』, 2018.<br /> 김원구, 「음성 인식 정보를 사용한 감정 인식」, 『한국지능시스템학회 학술발표 논문집』, 한국지능시스템 학회, 2008.<br /> 박소은, 「Spectrogram을 이용한 CNN 기반 음성 감정인식」, 『대한전기학회』, 2018.<br /> 오일석, 『패턴인식』, 교보문고, 2018.<br /> 유준형, 「모바일 넷 기반 상반신 이미지 분할 기법 연구」, 『한국정보과학회 학술발표논문지』, 한국정보과학회, 2018.<br /> 이명오, 「Channel Attention과 그룹 컨볼루션을 이용한 효율적인 얼굴 감정인식 CNN」, 『정보과학회논문지』, 한국정보과학회, 2019.<br /> 이민규, 「딥 러닝 기반 감정인식 시스템 개발」, 『한국방송미디어공학회 학술발표대회 논문집』, 한국방송미디어공학회, 2017.<br /> 이성주, 「음성인식 시스템을 위한 전처리 기술」, 『한국정보과학회』, 2017.<br /> 이창빈, 「반려동물과 사람간의 유대관계를 돕는 UX 디자인 연구」, 2017.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/nokh9503.github.io/categories/ai/'>AI</a>, <a href='/nokh9503.github.io/categories/deep-learning/'>Deep Learning</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/nokh9503.github.io/tags/ai/" class="post-tag no-text-decoration" >AI</a> <a href="/nokh9503.github.io/tags/deep-learning/" class="post-tag no-text-decoration" >Deep Learning</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=딥러닝 기반 반려견 울음소리 감지와 감정 및 상태 분석(3) - 코딩이 싫은 컴공&url=https://nokh9503.github.io/nokh9503.github.io/posts/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EB%B0%98%EB%A0%A4%EA%B2%AC-%EC%9A%B8%EC%9D%8C%EC%86%8C%EB%A6%AC-%EA%B0%90%EC%A7%80%EC%99%80-%EA%B0%90%EC%A0%95-%EB%B6%84%EC%84%9D(3)/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=딥러닝 기반 반려견 울음소리 감지와 감정 및 상태 분석(3) - 코딩이 싫은 컴공&u=https://nokh9503.github.io/nokh9503.github.io/posts/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EB%B0%98%EB%A0%A4%EA%B2%AC-%EC%9A%B8%EC%9D%8C%EC%86%8C%EB%A6%AC-%EA%B0%90%EC%A7%80%EC%99%80-%EA%B0%90%EC%A0%95-%EB%B6%84%EC%84%9D(3)/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=딥러닝 기반 반려견 울음소리 감지와 감정 및 상태 분석(3) - 코딩이 싫은 컴공&url=https://nokh9503.github.io/nokh9503.github.io/posts/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EB%B0%98%EB%A0%A4%EA%B2%AC-%EC%9A%B8%EC%9D%8C%EC%86%8C%EB%A6%AC-%EA%B0%90%EC%A7%80%EC%99%80-%EA%B0%90%EC%A0%95-%EB%B6%84%EC%84%9D(3)/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/nokh9503.github.io/posts/%EB%B0%B1%EC%A4%80-1715-%EC%B9%B4%EB%93%9C-%EC%A0%95%EB%A0%AC%ED%95%98%EA%B8%B0/">[백준 1715번] 카드 정렬하기</a><li><a href="/nokh9503.github.io/posts/%EC%9E%90%EB%A3%8C%EA%B5%AC%EC%A1%B0-%ED%81%90(Queue)/">[자료구조]큐(Queue)</a><li><a href="/nokh9503.github.io/posts/%EB%B0%B1%EC%A4%80-2133-%ED%83%80%EC%9D%BC-%EC%B1%84%EC%9A%B0%EA%B8%B0/">[백준 2133번] 타일 채우기</a><li><a href="/nokh9503.github.io/posts/%EB%B0%B1%EC%A4%80-2839-%EC%84%A4%ED%83%95-%EB%B0%B0%EB%8B%AC/">[백준 2839번] 설탕 배달</a><li><a href="/nokh9503.github.io/posts/%EB%B0%B1%EC%A4%80-1463-1%EB%A1%9C-%EB%A7%8C%EB%93%A4%EA%B8%B0/">[백준 1463번] 1로 만들기</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/nokh9503.github.io/tags/python/">Python</a> <a class="post-tag" href="/nokh9503.github.io/tags/algorithm/">Algorithm</a> <a class="post-tag" href="/nokh9503.github.io/tags/baekjoon/">Baekjoon</a> <a class="post-tag" href="/nokh9503.github.io/tags/dp/">DP</a> <a class="post-tag" href="/nokh9503.github.io/tags/ai/">AI</a> <a class="post-tag" href="/nokh9503.github.io/tags/deep-learning/">Deep Learning</a> <a class="post-tag" href="/nokh9503.github.io/tags/greedy/">Greedy</a> <a class="post-tag" href="/nokh9503.github.io/tags/string/">String</a> <a class="post-tag" href="/nokh9503.github.io/tags/brute-force/">Brute-Force</a> <a class="post-tag" href="/nokh9503.github.io/tags/mathematics/">Mathematics</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/nokh9503.github.io/posts/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EB%B0%98%EB%A0%A4%EA%B2%AC-%EC%9A%B8%EC%9D%8C%EC%86%8C%EB%A6%AC-%EA%B0%90%EC%A7%80%EC%99%80-%EA%B0%90%EC%A0%95-%EB%B6%84%EC%84%9D(1)/"><div class="card-body"> <span class="timeago small" > Dec 13, 2020 <i class="unloaded">2020-12-13T01:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>딥러닝 기반 반려견 울음소리 감지와 감정 및 상태 분석(1)</h3><div class="text-muted small"><p> Analysis of Emotional Conditions through the Barking of Dogs Based on Deep Learning 이 주제는 대학교 졸업 논문으로 쓴 주제이다. 교수님들과 같이 연구할 수 있는 다양한 주제들이 있었지만 나는 산업에서 다룰 수 있는 주제를 하기를 원해서 스타트업과 같이 진행을 했다. 비록, 초창기 스...</p></div></div></a></div><div class="card"> <a href="/nokh9503.github.io/posts/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EB%B0%98%EB%A0%A4%EA%B2%AC-%EC%9A%B8%EC%9D%8C%EC%86%8C%EB%A6%AC-%EA%B0%90%EC%A7%80%EC%99%80-%EA%B0%90%EC%A0%95-%EB%B6%84%EC%84%9D(2)/"><div class="card-body"> <span class="timeago small" > Dec 13, 2020 <i class="unloaded">2020-12-13T01:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>딥러닝 기반 반려견 울음소리 감지와 감정 및 상태 분석(2)</h3><div class="text-muted small"><p> 3. 프로젝트 내용 3.1 제안 방법   추출한 음원파일을 Mel-spectrogram으로 변환하고 frequency scale, time-step 등과 같은 이미지 변환에 대한 hyper parameter를 initialize하여 이미지 파일로 만든다.   이후 비지도 학습을 이용하여 입력 값에 대한 label이 주어지지 않은 데이터들을 군...</p></div></div></a></div><div class="card"> <a href="/nokh9503.github.io/posts/CNN%EC%9D%98-%EA%B5%AC%EC%A1%B0%EC%99%80-%EC%98%88%EC%A0%9C/"><div class="card-body"> <span class="timeago small" > Dec 28, 2020 <i class="unloaded">2020-12-28T01:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>CNN의 구조와 예제</h3><div class="text-muted small"><p> 컨볼루션 신경망(CNN)을 알아가기 전에 영상 인식(Image Recognition)은 영상 안의 물체를 인식하거나 분류하는 것이다. 컴퓨터가 자동으로 영상 안의 사물을 인식할 수 있다면 얼마나 편리한 세상이 올까? 아직까지는 컴퓨터는 인간의 수준만큼 영상을 인식하고 판별하지 못한다. 하지만 최근에 많은 연구들이 활발하게 진행되고 있고 많은 사례들...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/nokh9503.github.io/posts/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EB%B0%98%EB%A0%A4%EA%B2%AC-%EC%9A%B8%EC%9D%8C%EC%86%8C%EB%A6%AC-%EA%B0%90%EC%A7%80%EC%99%80-%EA%B0%90%EC%A0%95-%EB%B6%84%EC%84%9D(2)/" class="btn btn-outline-primary"><p>딥러닝 기반 반려견 울음소리 감지와 감정 및 상태 분석(2)</p></a> <a href="/nokh9503.github.io/posts/%EB%B0%B1%EC%A4%80-2839-%EC%84%A4%ED%83%95-%EB%B0%B0%EB%8B%AC/" class="btn btn-outline-primary"><p>[백준 2839번] 설탕 배달</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://twitter.com/username">your_full_name</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy/" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/nokh9503.github.io/tags/python/">Python</a> <a class="post-tag" href="/nokh9503.github.io/tags/algorithm/">Algorithm</a> <a class="post-tag" href="/nokh9503.github.io/tags/baekjoon/">Baekjoon</a> <a class="post-tag" href="/nokh9503.github.io/tags/dp/">DP</a> <a class="post-tag" href="/nokh9503.github.io/tags/ai/">AI</a> <a class="post-tag" href="/nokh9503.github.io/tags/deep-learning/">Deep Learning</a> <a class="post-tag" href="/nokh9503.github.io/tags/greedy/">Greedy</a> <a class="post-tag" href="/nokh9503.github.io/tags/string/">String</a> <a class="post-tag" href="/nokh9503.github.io/tags/brute-force/">Brute Force</a> <a class="post-tag" href="/nokh9503.github.io/tags/mathematics/">Mathematics</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/nokh9503.github.io/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://nokh9503.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
